kind: Pod
metadata:
  name: jnlp
  annotations:
    container.apparmor.security.beta.kubernetes.io/jenkins-builder: unconfined
    # container.seccomp.security.alpha.kubernetes.io/jenkins-builder: unconfined
spec:
  securityContext:
    serviceAccountName: jenkins
  containers:
  - name: jnlp
    # image: jenkins/jnlp-slave:3.40-1
    image: jmaclean/jenkins-jnlp-slave:3.40-1
    workingDir: /home/jenkins/agent
  - name: jenkins-builder
    workingDir: /home/jenkins/agent
    # image: r.j3ss.co/img:v0.5.7
    image: jmaclean/jenkins-builder:0.5.7
    imagePullPolicy: Always
    # imagePullPolicy: IfNotPresent
    securityContext:
      procMount: Unmasked
      capabilities:
        add:
        - SYS_ADMIN
      # runAsUser: 1000
      rawProc: true

      # allowPrivilegeEscalation: false
      # readOnlyRootFilesystem: true
    #   privileged: true
    
    resources:
      requests:
        memory: "64Mi"
        cpu: "250m"
      limits:
        memory: "128Mi"
        cpu: "500m"
    command:
    - cat
    tty: true 
