pipeline {
  environment {
    registry = "jmaclean/docker_hub_account/poc-trigger-by-tag"
    registryCredential = 'futurice-jmaclean-docker'
    dockerImage = ''
  }
  agent any
  stages {
    stage ('Process all environment variables') {
      steps {
        sh """
export LAST_GIT_BUILD_TAG=\$(git tag | sort | egrep "^v-" | tail -1)
export LAST_GIT_DEPLOY_TAG=\$(git tag | sort | egrep "^d-" | tail -1)

cat << EOT
----- GIT ----- GIT ----- GIT ----- GIT ----- GIT ----- \
GIT_COMMIT: "$GIT_COMMIT"
EOT 2>&1 >/dev/null
        """
      }
    }
    stage ('Close-out') {
      steps {
        sh 'echo HERE'
      }
    }
  }
}
